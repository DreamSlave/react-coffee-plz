import{r as i,b as H,u as E,a as L,j as s,e as A}from"./index-03aa8170.js";import{D as V,e as y,k as R}from"./react-datepicker-dcc5e419.js";import{A as _,a as F}from"./api.config-7a1e0839.js";const Q=()=>{const h=i.useRef(!0),[l,p]=i.useState(new Date),[c,m]=i.useState(new Date),[u,N]=i.useState(""),[d,f]=i.useState(""),[x,g]=i.useState(""),[D,v]=i.useState([]),[j,o]=i.useState(!0),a=H(e=>e.party);i.useEffect(()=>{(async()=>{if(h.current)try{const r=await S();v(r),a.partyName&&N(a.partyName),a.cafeId?(g(a.cafeName),f(a.cafeId)):r.length>0&&(g(r[0].cafeName),f(r[0].cafeId)),a.endDate&&p(M(a.endDate)),a.endTime?m(P(a.endTime)):m(k()),h.current=!1}catch(r){console.error(r)}o(u!==""&&d!=="");const t=new Date,n=c.getTime()-t.getTime();l.getTime()>t.getTime()?o(!0):setTimeout(()=>{c.getTime()-t.getTime()>6e4?o(!0):o(!1)},n)})()},[a,u,d,x,l,c,j]);function S(){return _.get(`${F.defaultDomain}/cafe/info`).then(e=>e.data)}const T=e=>{N(e.target.value)},I=e=>{const t=D.find(n=>n.cafeId===e.cafeId);g(String(t==null?void 0:t.cafeName)??""),f(String(t==null?void 0:t.cafeId)??"")},w=E(),C=L(),b=function(){const e=l.toLocaleDateString("en-CA").replace(/-/g,""),t=c.toLocaleTimeString("en-US",{hour12:!1}).slice(0,-3).replace(":","");C(A(u,d,x,e,t)),w("/party/preview")};function M(e){const t=parseInt(e.substring(0,4),10),n=parseInt(e.substring(4,6),10)-1,r=parseInt(e.substring(6,8),10);return new Date(t,n,r)}function P(e){const t=new Date,n=parseInt(e.substring(0,2),10),r=parseInt(e.substring(2,4),10);return t.setHours(n),t.setMinutes(r),t}function k(){const e=new Date,t=e.getMinutes(),n=Math.ceil(t/15)*15;return n===60?(e.setHours(e.getHours()+1),e.setMinutes(0)):e.setMinutes(n),e.setSeconds(0),e.setMilliseconds(0),e}return s.jsxs("div",{id:"party",className:"element",children:[s.jsxs("h1",{children:["본격적으로",s.jsx("br",{}),s.jsx("span",{className:"point",children:"파티를 생성"}),"합니다."]}),s.jsxs("div",{className:"form-area",children:[s.jsxs("div",{className:"input",children:[s.jsx("div",{className:"label",children:"파티명"}),s.jsx("input",{type:"text",placeholder:"파티명을 입력하세요.",className:"",value:u,onChange:T})]}),s.jsxs("div",{children:[s.jsx("div",{className:"label",children:"카페선택"}),s.jsx("div",{className:"select",children:s.jsx(V,{onChange:e=>I(e),dataItem:D,itemKey:"cafeId",itemValue:"cafeName",defaultValue:d})})]}),s.jsxs("div",{className:"form_date mgb10",children:[s.jsx("div",{className:"label",children:"마감설정"}),s.jsx(y,{locale:R,dateFormat:"yyyy/MM/dd",shouldCloseOnSelect:!0,className:"datepicker",selected:l,minDate:new Date,onChange:e=>p(e)})]}),s.jsx("div",{className:"form_date mgb10",children:s.jsx(y,{className:"timepicker",selected:c,onChange:e=>m(e),showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,timeCaption:"Time",dateFormat:"hh:mm aa"})})]}),s.jsx("footer",{id:"footer",children:j?s.jsx("div",{className:"large-btn",onClick:b,children:"미리보기"}):s.jsx("div",{className:"large-btn bg_gray",children:"미리보기"})})]})};export{Q as default};
