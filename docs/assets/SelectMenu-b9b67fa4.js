import{r,u as y,j as s,a as m}from"./index-eddb4896.js";import{s as E}from"./search-ic-4293fc31.js";import{A as f,a as g}from"./api.config-aa286da0.js";import{C as w}from"./CSSTransition-c14a972c.js";import"./setPrototypeOf-0bb37fbe.js";function U({partyNo:c,cafeId:l,menu:a,orderer:i,show:d,toggleShowPopup:p}){const[u,N]=r.useState(""),x=y(),h=n=>{N(n.target.value)},j=async()=>{let n=a.menuId==="MENU9999"?u:a.menuNm;if(n.trim()==="")return alert("메뉴명을 확인해주세요."),!1;if(a.menuId==="MENU9999"){let{newMenuId:o}=await v(n);a.menuId=o}let t={userId:i.userId,menuId:a.menuId,cafeId:l,partyId:c};f.post(`${g.defaultDomain}/order/save`,t).then(o=>{if(!o||!o.ok){alert(`처리 실패하였습니다.
관리자에게 문의해주세요.`);return}x(`/order/complete/${i.partyNo}/${encodeURIComponent(n)}`)}).catch(o=>{console.error("[/order/save] Error occurred ::: ",o)})},v=async n=>{await f.post(`${g.defaultDomain}/menu/save`,{cafeId:l,menuNm:n}).then(t=>!t||!t.ok?(alert(`처리 실패하였습니다.
관리자에게 문의해주세요.`),""):t.menuId).catch(t=>{console.error("[/menu/save] Error occurred ::: ",t)})};return s.jsx(w,{in:d,timeout:5e3,className:"fade",children:s.jsx("div",{children:s.jsx("div",{id:"popup",className:"popup",children:s.jsxs("div",{className:"pop_confirm",children:[s.jsx("h2",{children:"선택한 메뉴를 확인해주세요."}),s.jsxs("div",{className:"person-info",children:[i.name," ",i.rank,"(",i.team,")"]}),a.menuId==="MENU9999"?s.jsxs("div",{children:[s.jsx("input",{type:"text",placeholder:"메뉴명 입력",value:u,onChange:h,className:"mgt10 mgb5"}),s.jsx("div",{className:"point mgb25",children:"작성하기 전에 진짜 없는 메뉴인지 확인하셨나요?"})]}):s.jsx("div",{className:"menunm",children:a.menuNm}),s.jsx("div",{className:"btn-area",children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx("div",{className:"large-btn bg_sub point",onClick:p,children:"재선택"})}),s.jsx("li",{children:s.jsx("div",{className:"large-btn",onClick:j,children:"확인"})})]})})]})})})})}const _=()=>{const c={partyNo:m(e=>e.order.partyNo),userId:m(e=>e.order.userId),name:m(e=>e.order.name),team:m(e=>e.order.team),rank:m(e=>e.order.rank)},[l,a]=r.useState(""),[i,d]=r.useState(""),[p,u]=r.useState([]),[N,x]=r.useState(""),[h,j]=r.useState(),[v]=r.useState(["아이스","핫","라떼","에이드","샷추가","생과일","아메리카노"]),[n,t]=r.useState(!1);r.useEffect(()=>{C()},[i]);const o=e=>{a(e.target.value)},S=()=>{d(l)},M=e=>{a(e),d(e)},C=()=>{f.get(`${g.defaultDomain}/menu/info/${c.partyNo}`).then(e=>{if(!e||!e.ok){u([{menuId:"MENU9999",menuNm:"직접입력"}]),alert(`처리 실패하였습니다.
관리자에게 문의해주세요.`);return}x(e.cafeId),u(e.menuList??[{menuId:"MENU9999",menuNm:"직접입력"}])}).catch(e=>{console.error("[/order/save] Error occurred ::: ",e)})},I=()=>{t(e=>!e)},k=e=>{I(),j(e)};return s.jsxs("div",{children:[n&&h&&s.jsx(U,{partyNo:c.partyNo,cafeId:N,menu:h,orderer:c,show:n,toggleShowPopup:I}),s.jsxs("div",{id:"order",className:"element selectmenu",children:[s.jsxs("h1",{children:[s.jsx("span",{className:"point",children:"메뉴를"}),s.jsx("br",{}),"선택해주세요."]}),s.jsxs("div",{className:"person-info bg_sub point",children:[c.name," ",c.rank,"(",c.team,")"]}),s.jsxs("div",{className:"form-search mgt25 mgb15",children:[s.jsx("div",{className:"input",children:s.jsx("input",{type:"text",placeholder:"검색",value:l,onChange:o,className:""})}),s.jsx("div",{className:"btn",children:s.jsx("img",{className:"search-ic",alt:"Search ic",src:E,onClick:S})})]}),s.jsx("div",{className:"tag-group",children:v.map((e,b)=>s.jsxs("div",{className:"menu-tag bg_pink white",onClick:()=>M(e),children:["# ",e]},b))}),s.jsx("div",{className:"orderer-list mgt25",children:p.map(e=>s.jsx("div",{className:"item",onClick:()=>k(e),children:e.menuNm},e.menuId))})]})]})};export{_ as default};
