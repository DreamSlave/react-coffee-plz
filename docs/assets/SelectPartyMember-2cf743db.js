import{r as l,c as N,b as L,u as _,a as V,j as t,s as T}from"./index-1664d321.js";import{C as p}from"./CheckBox-a751e0dd.js";import{A,a as R}from"./api.config-7a1e0839.js";const P=()=>{const[i,h]=l.useState([]),[d,u]=l.useState([]),[g,f]=l.useState(!0),[k,x]=l.useState(!0),{showLoading:b,hideLoading:w}=N();l.useEffect(()=>{i.filter(e=>e.checked).length<1?f(!1):f(!0)},[i]);const j=L(e=>e.party);l.useEffect(()=>{(async()=>{try{const s=await E();if(k){const r=s.map(n=>{const a=j.memberList.some(S=>S.userId===n.userId);return{...n,checked:a}}),c=[...new Set(s.map(n=>n.team))].map(n=>({team:n,checked:r.filter(a=>a.team===n).every(a=>a.checked===!0),isView:!!r.filter(a=>a.team===n).some(a=>a.checked===!0)}));h(r),u(c),x(!1)}}catch(s){console.error("Error fetching member list:",s)}})()},[]);const v=(e,s)=>{const r=[...d];r[e].isView=!s,u(r)},m=(e,s,r)=>{const o=[...i];switch(e){case"USERID":o.forEach(c=>{c.userId===s&&(c.checked=r)});break;case"TEAM":o.forEach(c=>{c.team===s&&(c.checked=r)});break}h(o)},y=_(),M=V(),C=function(){const e=i.filter(s=>s.checked===!0).map(s=>({userId:s.userId,rank:s.rank,team:s.team,name:s.name}));M(T(e)),y("/party/save")},E=async()=>{b();try{return(await A.get(`${R.defaultDomain}/users`)).data}catch(e){throw console.error(e),e}finally{w()}};return t.jsxs("div",{id:"party",className:"element",children:[t.jsxs("h1",{children:[t.jsx("span",{className:"point",children:"대상인원을"}),t.jsx("br",{}),"선택해주세요."]}),t.jsxs("div",{className:"total_chck mgt20 mgb20",children:[i.filter(e=>e.checked).length,"명"]}),d.map((e,s)=>t.jsxs("div",{className:"chck_person",children:[t.jsx(p,{checked:e.checked,onChange:r=>m("TEAM",e.team,r.target.checked),children:t.jsx("span",{children:e.team},s+"_span")},e.team),t.jsx("div",{className:"p_2dpth_btn",onClick:()=>v(s,e.isView),children:e.isView?t.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",children:t.jsx("path",{d:"M7.5 3l7.5 8H0l7.5-8z",fill:"currentColor"})}):t.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",children:t.jsx("path",{d:"M7.5 12L0 4h15l-7.5 8z",fill:"currentColor"})})}),t.jsx("div",{className:"p_2dpth mgt10",children:e.isView&&i.filter(r=>r.team===e.team).map((r,o)=>t.jsx("div",{className:"checkbox",children:t.jsx(p,{checked:r.checked,onChange:c=>m("USERID",r.userId,c.target.checked),children:t.jsxs("span",{children:[r.name," ",r.rank," (",r.team,")"]},o)},r.name)}))},s+"_innder_div")]},s)),t.jsx("footer",{id:"footer",children:g?t.jsx("div",{className:"large-btn",onClick:C,children:"파티생성하기"}):t.jsx("div",{className:"large-btn bg_gray",children:"파티생성하기"})})]})};export{P as default};
