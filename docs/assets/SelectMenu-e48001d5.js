import{r as t,u as O,j as e,C as _,b as m,c as B}from"./index-1664d321.js";import{s as K}from"./search-ic-461cbee7.js";import{A as R,a as L}from"./api.config-7a1e0839.js";import{O as F}from"./EasterEgg-9d04d7e2.js";const G="/react-coffee-plz/assets/listloading-56b54439.gif";function q({partyNo:o,cafeId:p,menu:n,orderer:a,show:h,toggleShowPopup:j}){const[l,N]=t.useState(""),[S,g]=t.useState(!1),[I,f]=t.useState(!1),C=O(),b=i=>{N(i.target.value)},x=async()=>{let i=n.id===0?l:n.name;if(i.trim()==="")return alert("메뉴명을 확인해주세요."),!1;if(n.id===0&&["아무"].some(r=>i.includes(r)))return f(!0),g(!0),!1;let d={userId:a.userId,menuId:n.id===0?"":n.id,menuNm:i,cafeId:p,partyId:o};R.put(`${L.defaultDomain}/order/save`,d).then(r=>{if(!r||!r.ok){alert(`처리 실패하였습니다.
관리자에게 문의해주세요.`);return}C(`/order/complete/${a.partyNo}/${encodeURIComponent(i)}/${encodeURIComponent(a.name)}/${encodeURIComponent(a.team)}/${encodeURIComponent(a.rank)}`)}).catch(r=>{console.error("[/order/save] Error occurred ::: ",r)})},k=()=>{g(!1)};return e.jsx(_,{in:h,timeout:5e3,className:"fade",children:e.jsxs("div",{children:[e.jsx(F,{isOpen:S,onClose:k,isForSpecific:I}),e.jsx("div",{id:"popup",className:"popup",children:e.jsxs("div",{className:"pop_confirm",children:[e.jsx("h2",{children:"선택한 메뉴를 확인해주세요."}),e.jsxs("div",{className:"person-info",children:[a.name," ",a.rank,"(",a.team,")"]}),n.id===0?e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"메뉴명 입력",value:l,onChange:b,className:"mgt10 mgb5",maxLength:50}),e.jsx("div",{className:"point mgb25",children:"작성하기 전에 진짜 없는 메뉴인지 확인하셨나요?"})]}):e.jsx("div",{className:"menunm",children:n.name}),e.jsx("div",{className:"btn-area",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("div",{className:"large-btn bg_sub point",onClick:j,children:"취소"})}),e.jsx("li",{children:e.jsx("div",{className:"large-btn",onClick:x,children:"확인"})})]})})]})})]})})}const Y=()=>{const o={partyNo:m(s=>s.order.partyNo),userId:m(s=>s.order.userId),name:m(s=>s.order.name),team:m(s=>s.order.team),rank:m(s=>s.order.rank)},[p,n]=t.useState(""),[a,h]=t.useState(""),[j,l]=t.useState([]),[N,S]=t.useState(""),[g,I]=t.useState(""),[f,C]=t.useState(),[b]=t.useState(["아이스","핫","라떼","에이드","샷추가","생과일","아메리카노"]),[x,k]=t.useState(!1),[i,d]=t.useState(1),[r,$]=t.useState(!0),[w,E]=t.useState(!1),v=t.useRef(null);t.useRef(null),B();const M=t.useRef(!0);t.useEffect(()=>{M.current&&(window.scrollTo(0,0),M.current=!1),U(i)},[a,i]);const V=s=>{n(s.target.value)},A=s=>{s.key==="Enter"&&y()},y=()=>{h(p),d(1),l([])},T=s=>{n(s),h(s),d(1)},U=s=>{E(!0),R.get(`${L.defaultDomain}/menu/info/${o.partyNo}?page=${s}&searchTag=${a}`).then(u=>{const c=u.data;c.content&&c.content.length>0&&(S(c.content[0].cafeId),I(c.content[0].cafeName)),$(s===c.totalPages||c.totalPages===0),l(s===1?[{id:0,name:"직접입력"},{id:99,name:"괜찮습니다."},...c.content]:H=>[...H,...c.content]),E(!1)})},P=()=>{k(s=>!s)},z=s=>{P(),C(s)},D=t.useCallback(s=>{w||r||(v.current&&v.current.disconnect(),v.current=new IntersectionObserver(u=>{u[0].isIntersecting&&d(c=>c+1)},{rootMargin:"0px 0px 100px 0px"}),s&&v.current.observe(s))},[w]);return e.jsxs("div",{children:[x&&f&&e.jsx(q,{partyNo:o.partyNo,cafeId:N,menu:f,orderer:o,show:x,toggleShowPopup:P}),e.jsxs("div",{id:"order",className:"element selectmenu",children:[e.jsxs("h1",{children:[e.jsx("span",{className:"point",children:"메뉴를"}),e.jsx("br",{}),"선택해주세요."]}),e.jsx("div",{className:"cafename",children:e.jsx("b",{children:g})}),e.jsxs("div",{className:"person-info bg_sub point",children:[o.name," ",o.rank,"(",o.team,")"]}),e.jsxs("div",{className:"form-search mgt25 mgb15",children:[e.jsx("div",{className:"input",children:e.jsx("input",{type:"text",placeholder:"검색",value:p,onChange:V,onKeyDown:A,className:""})}),e.jsx("div",{className:"btn",children:e.jsx("img",{className:"search-ic",alt:"Search ic",src:K,onClick:y})})]}),e.jsx("div",{className:"tag-group",children:b.map((s,u)=>e.jsxs("div",{className:"menu-tag bg_pink white",onClick:()=>T(s),children:["# ",s]},u))}),e.jsxs("div",{className:"orderer-list mgt25",children:[j.map(s=>e.jsxs("div",{className:"item",onClick:()=>z(s),children:[e.jsxs("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",children:[e.jsx("path",{d:"M7 4h1V0H7v4zM5 2v2H4V2h1z",fill:"currentColor"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.5A1.5 1.5 0 011.5 5h9a1.5 1.5 0 011.415 1H13.5A1.5 1.5 0 0115 7.5v2a1.5 1.5 0 01-1.5 1.5H12v.5A3.5 3.5 0 018.5 15h-5A3.5 3.5 0 010 11.5v-5zM12 10h1.5a.5.5 0 00.5-.5v-2a.5.5 0 00-.5-.5H12v3z",fill:"currentColor"})]}),s.name]},s.id)),w&&e.jsx("div",{className:"listloading",children:e.jsx("img",{className:"loading",alt:"loading",src:G})}),e.jsx("div",{ref:D})]})]})]})};export{Y as default};
