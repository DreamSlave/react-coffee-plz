import{r as a,u as E,j as e,C as H,b as u,c as T}from "./index-cf9f670b.js";import{s as _}from "./search-ic-461cbee7.js";import{A as M,a as w}from "./api.config-7a1e0839.js";const D="/react-coffee-plz/assets/listloading-56b54439.gif";function B({partyNo:i,cafeId:m,menu:n,orderer:t,show:h,toggleShowPopup:f}){const[r,v]=a.useState(""),j=E(),p= l=>{v(l.target.value)},N=async()=>{let l=n.id===0?r:n.name;if(l.trim()==="")return alert("메뉴명을 확인해주세요."),!1;if(n.id===0&&l==="욜룔룔룔료")return alert("이스터 에그 팝업!"),!1;let x={userId:t.userId,menuId:n.id===0?"":n.id,menuNm:l,cafeId:m,partyId:i};M.put(`${w.defaultDomain}/order/save`,x).then(o=>{if(!o||!o.ok){alert(`처리 실패하였습니다.
관리자에게 문의해주세요.`);return}j(`/order/complete/${t.partyNo}/${encodeURIComponent(l)}/${encodeURIComponent(t.name)}/${encodeURIComponent(t.team)}/${encodeURIComponent(t.rank)}`)}).catch(o=>{console.error("[/order/save] Error occurred ::: ",o)})};return e.jsx(H,{in:h,timeout:5e3,className:"fade",children:e.jsx("div",{children:e.jsx("div",{id:"popup",className:"popup",children:e.jsxs("div",{className:"pop_confirm",children:[e.jsx("h2",{children:"선택한 메뉴를 확인해주세요."}),e.jsxs("div",{className:"person-info",children:[t.name," ",t.rank,"(",t.team,")"]}),n.id===0?e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"메뉴명 입력",value:r,onChange:p,className:"mgt10 mgb5"}),e.jsx("div",{className:"point mgb25",children:"작성하기 전에 진짜 없는 메뉴인지 확인하셨나요?"})]}):e.jsx("div",{className:"menunm",children:n.name}),e.jsx("div",{className:"btn-area",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("div",{className:"large-btn bg_sub point",onClick:f,children:"취소"})}),e.jsx("li",{children:e.jsx("div",{className:"large-btn",onClick:N,children:"확인"})})]})})]})})})})}const F=()=>{const i={partyNo:u(s=>s.order.partyNo),userId:u(s=>s.order.userId),name:u(s=>s.order.name),team:u(s=>s.order.team),rank:u(s=>s.order.rank)},[m,n]=a.useState(""),[t,h]=a.useState(""),[f,r]=a.useState([]),[v,j]=a.useState(""),[p,N]=a.useState(),[l]=a.useState(["아이스","핫","라떼","에이드","샷추가","생과일","아메리카노"]),[x,o]=a.useState(!1),[b,S]=a.useState(1),[y,L]=a.useState(!0),[I,C]=a.useState(!1),g=a.useRef(null);a.useRef(null),T(),a.useEffect(()=>{A(b)},[t,b]);const P=s=>{n(s.target.value)},$=()=>{h(m),S(1),r([])},V=s=>{n(s),h(s),S(1)},A=s=>{C(!0),M.get(`${w.defaultDomain}/menu/info/${i.partyNo}?page=${s}&searchTag=${t}`).then(d=>{const c=d.data;c.content&&c.content.length>0&&j(c.content[0].cafeId),L(s===c.totalPages||c.totalPages===0),r(s===1?[{id:0,name:"직접입력"},{id:99,name:"괜찮습니다."},...c.content]:z=>[...z,...c.content]),C(!1)})},k=()=>{o(s=>!s)},R=s=>{k(),N(s)},U=a.useCallback(s=>{I||y||(g.current&&g.current.disconnect(),g.current=new IntersectionObserver(d=>{d[0].isIntersecting&&S(c=>c+1)},{rootMargin:"0px 0px 100px 0px"}),s&&g.current.observe(s))},[I]);return e.jsxs("div",{children:[x&&p&&e.jsx(B,{partyNo:i.partyNo,cafeId:v,menu:p,orderer:i,show:x,toggleShowPopup:k}),e.jsxs("div",{id:"order",className:"element selectmenu",children:[e.jsxs("h1",{children:[e.jsx("span",{className:"point",children:"메뉴를"}),e.jsx("br",{}),"선택해주세요."]}),e.jsxs("div",{className:"cafename",children:[e.jsx("b",{children:"cafe"})," 카페명표기"]}),e.jsxs("div",{className:"person-info bg_sub point",children:[i.name," ",i.rank,"(",i.team,")"]}),e.jsxs("div",{className:"form-search mgt25 mgb15",children:[e.jsx("div",{className:"input",children:e.jsx("input",{type:"text",placeholder:"검색",value:m,onChange:P,className:""})}),e.jsx("div",{className:"btn",children:e.jsx("img",{className:"search-ic",alt:"Search ic",src:_,onClick:$})})]}),e.jsx("div",{className:"tag-group",children:l.map((s,d)=>e.jsxs("div",{className:"menu-tag bg_pink white",onClick:()=>V(s),children:["# ",s]},d))}),e.jsxs("div",{className:"orderer-list mgt25",children:[f.map(s=>e.jsxs("div",{className:"item",onClick:()=>R(s),children:[e.jsxs("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",children:[e.jsx("path",{d:"M7 4h1V0H7v4zM5 2v2H4V2h1z",fill:"currentColor"}),e.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 6.5A1.5 1.5 0 011.5 5h9a1.5 1.5 0 011.415 1H13.5A1.5 1.5 0 0115 7.5v2a1.5 1.5 0 01-1.5 1.5H12v.5A3.5 3.5 0 018.5 15h-5A3.5 3.5 0 010 11.5v-5zM12 10h1.5a.5.5 0 00.5-.5v-2a.5.5 0 00-.5-.5H12v3z",fill:"currentColor"})]}),s.name]},s.id)),I&&e.jsx("div",{className:"listloading",children:e.jsx("img",{className:"loading",alt:"loading",src:D})}),e.jsx("div",{ref:U})]})]})]})};export{F as default};
