import{r as o,a as C,u as w,c as N,j as t,s as _}from"./index-eddb4896.js";import{C as p}from"./CheckBox-6ddb4e2b.js";import{A as V,a as L}from"./api.config-aa286da0.js";const R=()=>{const[i,l]=o.useState([]),[h,u]=o.useState([]),[k,f]=o.useState(!0),[b,j]=o.useState(!0);o.useEffect(()=>{i.filter(e=>e.checked).length<1?f(!1):f(!0)},[i]);const g=C(e=>e.party);o.useEffect(()=>{(async()=>{try{const s=await E();if(b){const r=s.map(n=>{const d=g.memberList.some(S=>S.userId===n.userId);return{...n,checked:d}}),c=[...new Set(s.map(n=>n.team))].map(n=>({team:n,checked:r.filter(d=>d.team===n).every(d=>d.checked===!0),isView:!1}));l(r),u(c),j(!1)}}catch(s){console.error("Error fetching member list:",s)}})()},[]);const x=(e,s)=>{const r=[...h];r[e].isView=!s,u(r)},m=(e,s,r)=>{const a=[...i];switch(e){case"USERID":a.forEach(c=>{c.userId===s&&(c.checked=r)});break;case"TEAM":a.forEach(c=>{c.team===s&&(c.checked=r)});break}l(a)},v=w(),M=N(),y=function(){const e=i.filter(s=>s.checked===!0).map(s=>({userId:s.userId,rank:s.rank,team:s.team,name:s.name}));M(_(e)),v("/party/save")};function E(){return V.get(`${L.defaultDomain}/users`).then(e=>e.json()).then(e=>e.data)}return t.jsxs("div",{id:"party",className:"element",children:[t.jsxs("h1",{children:[t.jsx("span",{className:"point",children:"대상인원을"}),t.jsx("br",{}),"선택해주세요."]}),t.jsxs("div",{className:"total_chck",children:[i.filter(e=>e.checked).length,"명"]}),h.map((e,s)=>t.jsxs("div",{className:"chck_person",children:[t.jsx(p,{checked:e.checked,onChange:r=>m("TEAM",e.team,r.target.checked),children:t.jsx("span",{children:e.team},s+"_span")},e.team),t.jsxs("div",{className:"p_2dpth_btn",onClick:()=>x(s,e.isView),children:["  ",e.isView?"^":"⌄","   "]}),t.jsx("div",{className:"p_2dpth",children:e.isView&&i.filter(r=>r.team===e.team).map((r,a)=>t.jsx(p,{checked:r.checked,onChange:c=>m("USERID",r.userId,c.target.checked),children:t.jsx("div",{children:t.jsxs("div",{children:[r.name," ",r.rank," (",r.team,")"]},a)},a)},r.name))},s+"_innder_div")]},s)),t.jsx("footer",{id:"footer",children:k?t.jsx("div",{className:"large-btn",onClick:y,children:"파티생성하기"}):t.jsx("div",{className:"large-btn bg_gray",children:"파티생성하기"})})]})};export{R as default};
