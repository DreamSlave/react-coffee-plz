import{r as o,c as N,b as _,u as L,a as V,j as t,s as T}from"./index-35989979.js";import{C as p}from"./CheckBox-ca6ad048.js";import{A,a as D}from"./api.config-aa286da0.js";const q=()=>{const[i,l]=o.useState([]),[h,u]=o.useState([]),[k,f]=o.useState(!0),[b,j]=o.useState(!0),{showLoading:g,hideLoading:x}=N();o.useEffect(()=>{i.filter(e=>e.checked).length<1?f(!1):f(!0)},[i]);const v=_(e=>e.party);o.useEffect(()=>{(async()=>{try{const s=await S();if(b){const r=s.map(n=>{const d=v.memberList.some(C=>C.userId===n.userId);return{...n,checked:d}}),a=[...new Set(s.map(n=>n.team))].map(n=>({team:n,checked:r.filter(d=>d.team===n).every(d=>d.checked===!0),isView:!1}));l(r),u(a),j(!1)}}catch(s){console.error("Error fetching member list:",s)}})()},[]);const y=(e,s)=>{const r=[...h];r[e].isView=!s,u(r)},m=(e,s,r)=>{const c=[...i];switch(e){case"USERID":c.forEach(a=>{a.userId===s&&(a.checked=r)});break;case"TEAM":c.forEach(a=>{a.team===s&&(a.checked=r)});break}l(c)},w=L(),M=V(),E=function(){const e=i.filter(s=>s.checked===!0).map(s=>({userId:s.userId,rank:s.rank,team:s.team,name:s.name}));M(T(e)),w("/party/save")},S=async()=>{g();try{return(await(await A.get(`${D.defaultDomain}/users`)).json()).data}catch(e){throw console.error(e),e}finally{x()}};return t.jsxs("div",{id:"party",className:"element",children:[t.jsxs("h1",{children:[t.jsx("span",{className:"point",children:"대상인원을"}),t.jsx("br",{}),"선택해주세요."]}),t.jsxs("div",{className:"total_chck",children:[i.filter(e=>e.checked).length,"명"]}),h.map((e,s)=>t.jsxs("div",{className:"chck_person",children:[t.jsx(p,{checked:e.checked,onChange:r=>m("TEAM",e.team,r.target.checked),children:t.jsx("span",{children:e.team},s+"_span")},e.team),t.jsxs("div",{className:"p_2dpth_btn",onClick:()=>y(s,e.isView),children:["  ",e.isView?"^":"⌄","   "]}),t.jsx("div",{className:"p_2dpth",children:e.isView&&i.filter(r=>r.team===e.team).map((r,c)=>t.jsx(p,{checked:r.checked,onChange:a=>m("USERID",r.userId,a.target.checked),children:t.jsx("div",{children:t.jsxs("div",{children:[r.name," ",r.rank," (",r.team,")"]},c)},c)},r.name))},s+"_innder_div")]},s)),t.jsx("footer",{id:"footer",children:k?t.jsx("div",{className:"large-btn",onClick:E,children:"파티생성하기"}):t.jsx("div",{className:"large-btn bg_gray",children:"파티생성하기"})})]})};export{q as default};
