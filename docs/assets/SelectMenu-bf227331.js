import{r as a,u as V,j as e,C as E,b as o,c as A}from"./index-73f712f2.js";import{s as _}from"./search-ic-4293fc31.js";import{A as k,a as M}from"./api.config-7a1e0839.js";const D="/react-coffee-plz/assets/listloading-56b54439.gif";function z({partyNo:c,cafeId:g,menu:n,orderer:t,show:x,toggleShowPopup:f}){const[d,j]=a.useState(""),N=V(),u=i=>{j(i.target.value)},v=async()=>{let i=n.id===0?d:n.name;if(i.trim()==="")return alert("메뉴명을 확인해주세요."),!1;let m={userId:t.userId,menuId:n.id===0?"":n.id,menuNm:i,cafeId:g,partyId:c};k.put(`${M.defaultDomain}/order/save`,m).then(r=>{if(!r||!r.ok){alert(`처리 실패하였습니다.
관리자에게 문의해주세요.`);return}N(`/order/complete/${t.partyNo}/${encodeURIComponent(i)}/${encodeURIComponent(t.name)}/${encodeURIComponent(t.team)}/${encodeURIComponent(t.rank)}`)}).catch(r=>{console.error("[/order/save] Error occurred ::: ",r)})};return e.jsx(E,{in:x,timeout:5e3,className:"fade",children:e.jsx("div",{children:e.jsx("div",{id:"popup",className:"popup",children:e.jsxs("div",{className:"pop_confirm",children:[e.jsx("h2",{children:"선택한 메뉴를 확인해주세요."}),e.jsxs("div",{className:"person-info",children:[t.name," ",t.rank,"(",t.team,")"]}),n.id===0?e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"메뉴명 입력",value:d,onChange:u,className:"mgt10 mgb5"}),e.jsx("div",{className:"point mgb25",children:"작성하기 전에 진짜 없는 메뉴인지 확인하셨나요?"})]}):e.jsx("div",{className:"menunm",children:n.name}),e.jsx("div",{className:"btn-area",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("div",{className:"large-btn bg_sub point",onClick:f,children:"재선택"})}),e.jsx("li",{children:e.jsx("div",{className:"large-btn",onClick:v,children:"확인"})})]})})]})})})})}const q=()=>{const c={partyNo:o(s=>s.order.partyNo),userId:o(s=>s.order.userId),name:o(s=>s.order.name),team:o(s=>s.order.team),rank:o(s=>s.order.rank)},[g,n]=a.useState(""),[t,x]=a.useState(""),[f,d]=a.useState([]),[j,N]=a.useState(""),[u,v]=a.useState(),[i]=a.useState(["아이스","핫","라떼","에이드","샷추가","생과일","아메리카노"]),[m,r]=a.useState(!1),[I,y]=a.useState(1),[S,b]=a.useState(!1),p=a.useRef(null);a.useRef(null);const{showAlert:$}=A();a.useEffect(()=>{R(I)},[t,I]);const L=s=>{n(s.target.value)},w=s=>{n(s),x(s)},R=s=>{b(!0),k.get(`${M.defaultDomain}/menu/info/${c.partyNo}?page=${s}&searchTag=${t}`).then(l=>{const h=l.data;N(h.content[0].cafeId),d(U=>[...U,...s===1?[{id:0,name:"직접입력"},{id:99,name:"괜찮습니다."}]:[],...h.content]),b(!1)})},C=()=>{r(s=>!s)},P=s=>{C(),v(s)},T=a.useCallback(s=>{S||(p.current&&p.current.disconnect(),p.current=new IntersectionObserver(l=>{l[0].isIntersecting&&y(h=>h+1)}),s&&p.current.observe(s))},[S]);return e.jsxs("div",{children:[m&&u&&e.jsx(z,{partyNo:c.partyNo,cafeId:j,menu:u,orderer:c,show:m,toggleShowPopup:C}),e.jsxs("div",{id:"order",className:"element selectmenu",children:[e.jsxs("h1",{children:[e.jsx("span",{className:"point",children:"메뉴를"}),e.jsx("br",{}),"선택해주세요."]}),e.jsxs("div",{className:"person-info bg_sub point",children:[c.name," ",c.rank,"(",c.team,")"]}),e.jsxs("div",{className:"form-search mgt25 mgb15",children:[e.jsx("div",{className:"input",children:e.jsx("input",{type:"text",placeholder:"검색",value:g,onChange:L,className:""})}),e.jsx("div",{className:"btn",children:e.jsx("img",{className:"search-ic",alt:"Search ic",src:_,onClick:()=>$("This is an alert!")})})]}),e.jsx("div",{className:"tag-group",children:i.map((s,l)=>e.jsxs("div",{className:"menu-tag bg_pink white",onClick:()=>w(s),children:["# ",s]},l))}),e.jsxs("div",{className:"orderer-list mgt25",children:[f.map(s=>e.jsx("div",{className:"item",onClick:()=>P(s),children:s.name},s.id)),S&&e.jsx("div",{className:"listloading",children:e.jsx("img",{className:"loading",alt:"loading",src:D})}),e.jsx("div",{ref:T})]})]})]})};export{q as default};
